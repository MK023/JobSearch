<mxfile host="app.diagrams.net" modified="2025-02-15" agent="Claude" version="24.0.0" type="device">
  <diagram id="architecture" name="Architettura Generale">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Job Search Command Center - Architettura" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- Browser -->
        <mxCell id="browser" value="Browser&#xa;(utente)" style="shape=mxgraph.basic.cloud_callout;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=13;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="700" y="80" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- DOCKER COMPOSE GROUP -->
        <mxCell id="docker_group" value="Docker Compose Network: jobsearch (bridge)" style="swimlane;startSize=30;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;fontSize=12;fontColor=#333333;rounded=1;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="200" y="220" width="1200" height="700" as="geometry" />
        </mxCell>

        <!-- FRONTEND (nginx) -->
        <mxCell id="nginx_group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;arcSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="300" y="40" width="600" height="160" as="geometry" />
        </mxCell>
        <mxCell id="nginx_title" value="frontend (nginx:1.27-alpine)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=14;fontStyle=1;fontColor=#9673a6;" vertex="1" parent="docker_group">
          <mxGeometry x="430" y="45" width="340" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nginx_static" value="/static/&#xa;(CSS, JS)&#xa;servito diretto" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=0;" vertex="1" parent="docker_group">
          <mxGeometry x="320" y="85" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nginx_api" value="/api/v1/*&#xa;proxy_pass&#xa;→ backend:8000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=0;" vertex="1" parent="docker_group">
          <mxGeometry x="470" y="85" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nginx_ssr" value="/*&#xa;proxy_pass&#xa;→ backend:8000&#xa;(SSR Jinja2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=0;" vertex="1" parent="docker_group">
          <mxGeometry x="620" y="85" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="port80" value=":80" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontStyle=1;fontColor=#AE4132;" vertex="1" parent="docker_group">
          <mxGeometry x="260" y="100" width="40" height="30" as="geometry" />
        </mxCell>

        <!-- BACKEND -->
        <mxCell id="backend_group" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;arcSize=8;" vertex="1" parent="docker_group">
          <mxGeometry x="180" y="250" width="840" height="200" as="geometry" />
        </mxCell>
        <mxCell id="backend_title" value="backend (python:3.12-slim / uvicorn + FastAPI)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=14;fontStyle=1;fontColor=#82b366;" vertex="1" parent="docker_group">
          <mxGeometry x="340" y="255" width="530" height="30" as="geometry" />
        </mxCell>

        <!-- Middleware Stack -->
        <mxCell id="mw_stack" value="Middleware Stack" style="text;html=1;align=center;verticalAlign=middle;fontSize=11;fontStyle=5;fontColor=#666;" vertex="1" parent="docker_group">
          <mxGeometry x="195" y="290" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="mw1" value="SecurityHeaders" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="195" y="312" width="110" height="28" as="geometry" />
        </mxCell>
        <mxCell id="mw2" value="CORS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="195" y="344" width="110" height="28" as="geometry" />
        </mxCell>
        <mxCell id="mw3" value="TrustedHost" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="195" y="376" width="110" height="28" as="geometry" />
        </mxCell>
        <mxCell id="mw4" value="SlowAPI (rate limit)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="195" y="408" width="110" height="28" as="geometry" />
        </mxCell>

        <!-- Validation Layer -->
        <mxCell id="val_stack" value="Validation Layer" style="text;html=1;align=center;verticalAlign=middle;fontSize=11;fontStyle=5;fontColor=#666;" vertex="1" parent="docker_group">
          <mxGeometry x="40" y="290" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="val1" value="Input size limits" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="40" y="312" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="val2" value="Budget hard stop" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="40" y="344" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="val3" value="Atomic TX + rollback" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="40" y="376" width="120" height="28" as="geometry" />
        </mxCell>
        <mxCell id="val4" value="Datetime validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="40" y="408" width="120" height="28" as="geometry" />
        </mxCell>

        <!-- Route Groups -->
        <mxCell id="html_routes" value="HTML Routes&#xa;/ /login /logout&#xa;/cv /analyze&#xa;/analysis/{id}&#xa;/cover-letter" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="330" y="295" width="130" height="100" as="geometry" />
        </mxCell>
        <mxCell id="api_routes" value="API v1 (JSON)&#xa;/api/v1/status&#xa;/api/v1/batch/*&#xa;/api/v1/contacts&#xa;/api/v1/spending&#xa;/api/v1/dashboard&#xa;/api/v1/interviews/*&#xa;/api/v1/followup-*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="480" y="290" width="140" height="120" as="geometry" />
        </mxCell>

        <!-- Service Layer -->
        <mxCell id="services" value="Service Layer&#xa;analysis / cv / auth&#xa;cover_letter / contacts&#xa;dashboard / batch / audit&#xa;interview" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d0de;strokeColor=#996185;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="645" y="295" width="160" height="100" as="geometry" />
        </mxCell>

        <!-- Integrations -->
        <mxCell id="integrations" value="Integrations&#xa;anthropic_client (120s timeout, 3 retries)&#xa;cache (Protocol)&#xa;glassdoor" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d0de;strokeColor=#996185;fontSize=10;" vertex="1" parent="docker_group">
          <mxGeometry x="830" y="295" width="130" height="100" as="geometry" />
        </mxCell>
        <mxCell id="port8000" value=":8000 (interno)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#AE4132;" vertex="1" parent="docker_group">
          <mxGeometry x="70" y="340" width="110" height="30" as="geometry" />
        </mxCell>

        <!-- DB -->
        <mxCell id="db" value="db&#xa;PostgreSQL 16&#xa;(pgdata volume)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" vertex="1" parent="docker_group">
          <mxGeometry x="300" y="520" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="db_tables" value="users | cv_profiles | job_analyses&#xa;cover_letters | contacts | app_settings&#xa;glassdoor_cache | audit_logs | interviews" style="text;html=1;align=center;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#666;" vertex="1" parent="docker_group">
          <mxGeometry x="250" y="645" width="280" height="50" as="geometry" />
        </mxCell>

        <!-- Redis -->
        <mxCell id="redis" value="redis&#xa;Redis 7&#xa;(cache opzionale)" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" vertex="1" parent="docker_group">
          <mxGeometry x="700" y="520" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="redis_detail" value="API response cache (24h TTL)&#xa;graceful degradation → NullCache" style="text;html=1;align=center;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#666;" vertex="1" parent="docker_group">
          <mxGeometry x="670" y="645" width="240" height="40" as="geometry" />
        </mxCell>

        <!-- EXTERNAL: Claude API -->
        <mxCell id="claude" value="Anthropic Claude API&#xa;Haiku 4.5 / Sonnet 4.5" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=20;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1160" y="80" width="220" height="80" as="geometry" />
        </mxCell>

        <!-- EXTERNAL: Glassdoor -->
        <mxCell id="glassdoor" value="RapidAPI&#xa;Glassdoor Data" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;size=20;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1160" y="180" width="220" height="70" as="geometry" />
        </mxCell>

        <!-- CI/CD -->
        <mxCell id="cicd" value="GitHub Actions CI&#xa;pyflakes → pytest → docker build" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1160" y="280" width="220" height="50" as="geometry" />
        </mxCell>

        <!-- Fly.io -->
        <mxCell id="flyio" value="Fly.io (deploy prod)&#xa;single-container, auto-sleep" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1160" y="350" width="220" height="50" as="geometry" />
        </mxCell>

        <!-- ARROWS -->
        <!-- Browser → Nginx -->
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="browser" target="nginx_group" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow1_label" value="HTTP :80" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#666;" vertex="1" connectable="0" parent="arrow1">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Nginx → Backend -->
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#82b366;strokeWidth=2;" edge="1" source="nginx_group" target="backend_group" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow2_label" value="proxy_pass" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#82b366;" vertex="1" connectable="0" parent="arrow2">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Backend → DB -->
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d6b656;strokeWidth=2;" edge="1" source="backend_group" target="db" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow3_label" value="SQLAlchemy&#xa;(pool: 5+10)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#d6b656;" vertex="1" connectable="0" parent="arrow3">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Backend → Redis -->
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#b85450;strokeWidth=2;dashed=1;" edge="1" source="backend_group" target="redis" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow4_label" value="cache (opt)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#b85450;" vertex="1" connectable="0" parent="arrow4">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Backend → Claude API -->
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#6c8ebf;strokeWidth=2;" edge="1" source="integrations" target="claude" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow5_label" value="HTTPS" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#6c8ebf;" vertex="1" connectable="0" parent="arrow5">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- Backend → Glassdoor -->
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#6c8ebf;strokeWidth=1;dashed=1;" edge="1" source="integrations" target="glassdoor" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Internal arrows -->
        <mxCell id="arrow_routes_svc" style="rounded=1;strokeColor=#996185;strokeWidth=1;" edge="1" source="api_routes" target="services" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow_html_svc" style="rounded=1;strokeColor=#996185;strokeWidth=1;" edge="1" source="html_routes" target="services" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow_svc_int" style="rounded=1;strokeColor=#996185;strokeWidth=1;" edge="1" source="services" target="integrations" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <diagram id="data-model" name="Modello Dati">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <mxCell id="dm_title" value="Modello Dati (ER)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="600" y="20" width="200" height="40" as="geometry" />
        </mxCell>

        <!-- Users -->
        <mxCell id="t_users" value="users" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="100" y="100" width="250" height="180" as="geometry" />
        </mxCell>
        <mxCell id="u1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;fontStyle=0;" vertex="1" parent="t_users">
          <mxGeometry y="30" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;overflow=hidden;fontSize=10;" vertex="1" parent="u1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="u1">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_users">
          <mxGeometry y="60" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u2a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="u2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u2b" value="email VARCHAR(255) UNIQUE" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="u2">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_users">
          <mxGeometry y="90" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="u3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u3b" value="password_hash VARCHAR(255)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="u3">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_users">
          <mxGeometry y="120" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="u4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u4b" value="is_active BOOLEAN" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="u4">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_users">
          <mxGeometry y="150" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="u5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u5b" value="created_at TIMESTAMPTZ" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="u5">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>

        <!-- CV Profiles -->
        <mxCell id="t_cv" value="cv_profiles" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="100" y="360" width="250" height="210" as="geometry" />
        </mxCell>
        <mxCell id="cv1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cv">
          <mxGeometry y="30" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;overflow=hidden;fontSize=10;" vertex="1" parent="cv1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="cv1">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cv">
          <mxGeometry y="60" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv2a" value="FK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;overflow=hidden;fontSize=10;fontColor=#AE4132;" vertex="1" parent="cv2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv2b" value="user_id → users.id (CASCADE)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="cv2">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cv">
          <mxGeometry y="90" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cv3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv3b" value="raw_text TEXT" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="cv3">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cv">
          <mxGeometry y="120" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cv4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv4b" value="name VARCHAR(255)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="cv4">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cv">
          <mxGeometry y="150" width="250" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cv5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cv5b" value="created_at / updated_at TZ" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;overflow=hidden;fontSize=11;" vertex="1" parent="cv5">
          <mxGeometry x="40" width="210" height="30" as="geometry" />
        </mxCell>

        <!-- Job Analyses -->
        <mxCell id="t_analyses" value="job_analyses" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="480" y="80" width="280" height="510" as="geometry" />
        </mxCell>
        <mxCell id="ja1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="30" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="ja1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja1">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="60" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja2a" value="FK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;fontColor=#AE4132;" vertex="1" parent="ja2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja2b" value="cv_id → cv_profiles.id (CASCADE)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja2">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="90" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja3b" value="job_description TEXT" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja3">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="120" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja4b" value="company / role / location VARCHAR" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja4">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="150" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja5b" value="score INTEGER / recommendation" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja5">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja6" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="180" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja6a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja6">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja6b" value="status ENUM(da_valutare, ...)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja6">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja7" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="210" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja7a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja7">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja7b" value="strengths JSONB []" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja7">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja8" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="240" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja8a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja8">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja8b" value="gaps JSONB [{gap, severity, ...}]" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja8">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja9" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="270" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja9a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja9">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja9b" value="interview_scripts JSONB" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja9">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja10" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="300" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja10a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja10">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja10b" value="company_reputation JSONB" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja10">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja11" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="330" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja11a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja11">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja11b" value="model_used / tokens / cost_usd" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja11">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja12" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="360" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja12a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja12">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja12b" value="content_hash VARCHAR(64)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja12">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja13" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="390" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja13a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja13">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja13b" value="created_at / applied_at TZ" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja13">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja14" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="420" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja14a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="ja14">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja14b" value="followed_up BOOLEAN" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="ja14">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja15" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_analyses">
          <mxGeometry y="450" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja15a" value="IDX" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=2;fontSize=10;fontColor=#666;" vertex="1" parent="ja15">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ja15b" value="score, status, created_at, cv_id, hash" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;fontColor=#666;" vertex="1" parent="ja15">
          <mxGeometry x="40" width="240" height="30" as="geometry" />
        </mxCell>

        <!-- Cover Letters -->
        <mxCell id="t_cl" value="cover_letters" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="860" y="80" width="260" height="240" as="geometry" />
        </mxCell>
        <mxCell id="cl1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="30" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="cl1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl1">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl2a" value="FK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;fontColor=#AE4132;" vertex="1" parent="cl2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl2b" value="analysis_id → job_analyses.id" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl2">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="90" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cl3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl3b" value="language / content TEXT" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl3">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="120" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cl4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl4b" value="subject_lines JSONB" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl4">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="150" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cl5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl5b" value="model_used / tokens / cost_usd" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl5">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl6" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_cl">
          <mxGeometry y="180" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl6a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="cl6">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cl6b" value="created_at TIMESTAMPTZ" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="cl6">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>

        <!-- Contacts -->
        <mxCell id="t_contacts" value="contacts" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="860" y="380" width="260" height="270" as="geometry" />
        </mxCell>
        <mxCell id="co1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="30" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="co1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co1">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co2a" value="FK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;fontColor=#AE4132;" vertex="1" parent="co2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co2b" value="analysis_id → job_analyses.id" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co2">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="90" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="co3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co3b" value="name / email / phone" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co3">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="120" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="co4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co4b" value="company / linkedin_url" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co4">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="150" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="co5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co5b" value="notes TEXT / source" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co5">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co6" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_contacts">
          <mxGeometry y="180" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co6a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="co6">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="co6b" value="created_at TIMESTAMPTZ" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="co6">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>

        <!-- Audit Logs -->
        <mxCell id="t_audit" value="audit_logs" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="100" y="640" width="260" height="210" as="geometry" />
        </mxCell>
        <mxCell id="al1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_audit">
          <mxGeometry y="30" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="al1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="al1">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_audit">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al2a" value="FK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;fontColor=#AE4132;" vertex="1" parent="al2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al2b" value="user_id → users.id (SET NULL)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="al2">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_audit">
          <mxGeometry y="90" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="al3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al3b" value="action VARCHAR(50) INDEXED" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="al3">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_audit">
          <mxGeometry y="120" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="al4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al4b" value="detail TEXT / ip_address" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="al4">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al5" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_audit">
          <mxGeometry y="150" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al5a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="al5">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="al5b" value="created_at TIMESTAMPTZ INDEXED" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="al5">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>

        <!-- App Settings -->
        <mxCell id="t_settings" value="app_settings" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="480" y="650" width="260" height="180" as="geometry" />
        </mxCell>
        <mxCell id="as1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_settings">
          <mxGeometry y="30" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="as1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as1b" value="id INTEGER (singleton row)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="as1">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_settings">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as2a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="as2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as2b" value="anthropic_budget / total_cost_usd" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="as2">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_settings">
          <mxGeometry y="90" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="as3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as3b" value="total_tokens / total_analyses" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="as3">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_settings">
          <mxGeometry y="120" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="as4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="as4b" value="today_date / today_cost / today_tokens" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="as4">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>

        <!-- Glassdoor Cache -->
        <mxCell id="t_gd" value="glassdoor_cache" style="shape=table;startSize=30;container=1;collapsible=0;childLayout=tableLayout;fixedRows=1;rowLines=1;fontStyle=1;align=center;resizeLast=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="860" y="700" width="260" height="150" as="geometry" />
        </mxCell>
        <mxCell id="gd1" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_gd">
          <mxGeometry y="30" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd1a" value="PK" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontStyle=1;fontSize=10;" vertex="1" parent="gd1">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd1b" value="id UUID" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="gd1">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd2" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_gd">
          <mxGeometry y="60" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd2a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="gd2">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd2b" value="company_name UNIQUE INDEXED" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="gd2">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd3" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_gd">
          <mxGeometry y="90" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd3a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="gd3">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd3b" value="glassdoor_data TEXT (JSON)" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="gd3">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd4" value="" style="shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;fillColor=none;collapsible=0;dropTarget=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=11;" vertex="1" parent="t_gd">
          <mxGeometry y="120" width="260" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd4a" value="" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=10;" vertex="1" parent="gd4">
          <mxGeometry width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gd4b" value="rating / review_count / fetched_at" style="shape=partialRectangle;connectable=0;fillColor=none;top=0;left=0;bottom=0;right=0;fontSize=11;" vertex="1" parent="gd4">
          <mxGeometry x="40" width="220" height="30" as="geometry" />
        </mxCell>

        <!-- FK Relations -->
        <mxCell id="fk1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#AE4132;strokeWidth=2;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" source="t_users" target="cv2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fk1_label" value="1:N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=1;fontColor=#AE4132;" vertex="1" connectable="0" parent="fk1">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>
        <mxCell id="fk2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#AE4132;strokeWidth=2;" edge="1" source="cv1" target="ja2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fk2_label" value="1:N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=1;fontColor=#AE4132;" vertex="1" connectable="0" parent="fk2">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>
        <mxCell id="fk3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#AE4132;strokeWidth=2;" edge="1" source="ja1" target="cl2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fk3_label" value="1:N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=1;fontColor=#AE4132;" vertex="1" connectable="0" parent="fk3">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>
        <mxCell id="fk4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#AE4132;strokeWidth=2;" edge="1" source="ja1" target="co2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fk4_label" value="1:N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=11;fontStyle=1;fontColor=#AE4132;" vertex="1" connectable="0" parent="fk4">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>
        <mxCell id="fk5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#AE4132;strokeWidth=1;dashed=1;" edge="1" source="t_users" target="al2" parent="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fk5_label" value="1:N (SET NULL)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#AE4132;" vertex="1" connectable="0" parent="fk5">
          <mxGeometry x="-0.2" relative="1" as="geometry"><mxPoint as="offset" /></mxGeometry>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>

  <diagram id="request-flow" name="Flusso Richiesta">
    <mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <mxCell id="rf_title" value="Flusso Richiesta: Analisi CV vs Annuncio" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=18;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="500" height="40" as="geometry" />
        </mxCell>

        <!-- Steps -->
        <mxCell id="s1" value="1. Browser&#xa;POST /analyze&#xa;(CV + annuncio)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="100" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="s2" value="2. Nginx&#xa;proxy_pass&#xa;→ backend:8000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="220" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="s3" value="3. Middleware&#xa;SecurityHeaders&#xa;CORS → TrustedHost&#xa;SlowAPI → Session" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="270" y="220" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="s4" value="4. Auth Check&#xa;get_current_user()&#xa;sessione → user_id&#xa;→ DB query User" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="500" y="220" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="s5" value="5. Route Handler&#xa;analysis/routes.py&#xa;POST /analyze" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="730" y="220" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="s6" value="6. content_hash()&#xa;SHA-256(CV+annuncio)&#xa;↓&#xa;find_existing_analysis()&#xa;duplicato? → skip API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="380" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s7" value="7. Redis cache check&#xa;cache.get_json(key)&#xa;↓&#xa;HIT? → return cached&#xa;MISS? → call API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="260" y="380" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s8" value="8. Anthropic API&#xa;messages.create()&#xa;system + user prompt&#xa;↓&#xa;JSON response" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="480" y="380" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s9" value="9. JSON Parse&#xa;4 tentativi:&#xa;1. as-is&#xa;2. clean (trailing comma)&#xa;3. extract {...}&#xa;4. fix control chars&#xa;5. AI retry fix" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="700" y="380" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s10" value="10. Glassdoor merge&#xa;fetch_glassdoor_rating()&#xa;DB cache (30gg) o API&#xa;→ arricchisci reputation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="920" y="380" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s11" value="11. Persist&#xa;JobAnalysis → DB&#xa;add_spending() → DB&#xa;audit('analyze') → DB&#xa;db.commit()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;fontStyle=0;" vertex="1" parent="1">
          <mxGeometry x="40" y="540" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="s12" value="12. Render&#xa;Jinja2 template&#xa;analysis.html&#xa;↓&#xa;HTMLResponse" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="540" width="180" height="100" as="geometry" />
        </mxCell>

        <!-- Arrows -->
        <mxCell id="a1" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s1" target="s2" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a2" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s2" target="s3" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a3" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s3" target="s4" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a4" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s4" target="s5" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a5" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s5" target="s6" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a6" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s6" target="s7" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a7" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s7" target="s8" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a8" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s8" target="s9" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a9" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s9" target="s10" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a10" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s10" target="s11" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="a11" style="rounded=1;strokeColor=#333;strokeWidth=2;" edge="1" source="s11" target="s12" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
