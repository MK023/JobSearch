{# Cover letter result display #}
{% if cover_letter %}
<div class="card card-mb" id="cover-letter-result-card">
    <h2>Cover Letter generata</h2>

    <div>
        <div class="advice-title advice-title-green">Lettera</div>
        <div id="cover-letter-text" class="cover-letter-text">{{ cover_letter.content }}</div>
        <div class="button-row">
            <button class="btn btn-ghost btn-sm"
                    onclick="navigator.clipboard.writeText(document.getElementById('cover-letter-text').textContent).catch(function(){showToast('Impossibile copiare','error')})">
                Copia lettera
            </button>
            {% if cover_letter %}
            <a href="/cover-letter/{{ cover_letter.id }}/download" class="btn btn-primary btn-sm no-underline">
                Scarica DOCX
            </a>
            {% endif %}
        </div>
    </div>

    {% if cover_letter.subject_lines %}
    <div>
        <div class="advice-title advice-title-amber mt-md">Subject line suggerite</div>
        {% for sl in cover_letter.subject_lines %}
        <div class="subject-line-row">
            <span class="subject-line-text" id="subject-line-{{ loop.index }}">{{ sl }}</span>
            <button class="btn btn-ghost btn-sm"
                    onclick="navigator.clipboard.writeText(document.getElementById('subject-line-{{ loop.index }}').textContent).catch(function(){showToast('Impossibile copiare','error')})">
                Copia
            </button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="meta-small">
        Costo: ${{ '%.5f' % (cover_letter.cost_usd or 0) }} | {{ (cover_letter.tokens_input or 0) + (cover_letter.tokens_output or 0) }} token
    </div>
</div>
{% endif %}
